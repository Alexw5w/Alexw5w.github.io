<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>时间网络分析</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./协变量处理方法.html" rel="next">
<link href="./交叉滞后网络.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./横断面网络完整版.html">网络分析实战</a></li><li class="breadcrumb-item"><a href="./时间网络分析.html">时间网络分析</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
        <div class="sidebar-tools-collapse">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-collapse-item" href="https://github.com/hulitongjisuibi/hulitongjisuibi.github.io">
            Source Code
            </a>
          </li>
      </ul>
    </div>
</div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">关于本书</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./网络分析基础及指标.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">网络分析基础及指标</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">网络分析实战</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./横断面网络完整版.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">横断面网络</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./不同网络比较.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">不同网络比较</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./二分类变量网络分析.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">二分类变量的网络分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./混合变量网络分析.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">混合变量网络分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./有调节的网络.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">有调节的网络</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./交叉滞后网络.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">交叉滞后网络</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./时间网络分析.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">时间网络分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./协变量处理方法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">协变量处理方法</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./样本量估算.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">样本量估算</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./参考文献.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考文献</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#时间网络分析概述" id="toc-时间网络分析概述" class="nav-link active" data-scroll-target="#时间网络分析概述">1 时间网络分析概述</a></li>
  <li><a href="#r语言实战" id="toc-r语言实战" class="nav-link" data-scroll-target="#r语言实战">2 R语言实战</a></li>
  <li><a href="#几个需要注意的地方" id="toc-几个需要注意的地方" class="nav-link" data-scroll-target="#几个需要注意的地方">3 几个需要注意的地方</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./横断面网络完整版.html">网络分析实战</a></li><li class="breadcrumb-item"><a href="./时间网络分析.html">时间网络分析</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">时间网络分析</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="时间网络分析概述" class="level3">
<h3 class="anchored" data-anchor-id="时间网络分析概述">1 时间网络分析概述</h3>
<section id="几种数据类型" class="level4">
<h4 class="anchored" data-anchor-id="几种数据类型">1.1 几种数据类型</h4>
<p>首先，从测量次数角度，我们要注意区分几种数据类型：单一测量数据（每人一个测量）、面板数据（许多人测量了几次）、N = 1时间序列数据（一个人测量了多次）和N &gt; 1时间序列数据（几个人测量了多次）。</p>
</section>
<section id="时间网络分析" class="level4">
<h4 class="anchored" data-anchor-id="时间网络分析">1.2 时间网络分析</h4>
<p>时间网络分析（Temporal network analysis）是网络分析的最新进展之一，它将关系和时间维度结合到一个单一的分析框架中，即：时间网络，也称为时间序列网络、时变网络、动态网络或演化网络。</p>
<p>时间网络分析是一种新颖而具有前景的方法，它比其他更常用的纵向建模技术[如交叉滞后面板模型(CLPM)，回归模型]具有优势。</p>
<p>首先，时态网络分析中经常涉及到建立图形向量自回归(GVAR)模型，其允许估计考虑时间上个体内差异的有向网络，而CLPM没有分离个体内效应（within-person effects）和个体间效应（between-person effects），这可能导致变量之间因果关系的不正确结论。尽管后来发展起来的CLPM ——随机截距 CLPM可以将时间不变（time-invariant）、类似特质（trait-like）的个体间效应与个体内效应区分开来，但它需要更大的样本和更大的检验效能，特别是对于具有更多变量的更复杂的模型。</p>
<p><img src="images/几种效应设计图.png" class="img-fluid">{引用自WITH R NETWORK PSYCHOMETRICS=“” fig-align=“center”}</p>
<p>其次，时间网络分析评估模型中每个变量的中心性，这可以识别网络中最重要的(或最有影响力的)节点。由于高度中心的节点影响网络中最多的变量，因此它们可能是干预的有用目标。</p>
</section>
<section id="分析思路" class="level4">
<h4 class="anchored" data-anchor-id="分析思路">1.3 分析思路</h4>
<p>时间网络分析还在发展之中，并不完善。对于N=1的时间序列网络分析，主要思想是通图形向量自回归模型（GVAR）进行处理；对于N&gt;1的时间序列，可能会更多地考虑多层VAR（mlVAR包实现了这种统计建模方法）。</p>
<p>在VAR中，在连续的时间点之间使用线性回归来建模时间依赖关系，允许人们在控制了时间效应（同期效应）后，获得跨时间的关系（时间效应）和同一测量窗口中的关系的单独估计。VAR变体是这一部分的核心焦点是图形VAR（GVAR）模型，其中同时的效果被进一步建模为高斯图形模型。因此，GVAR模型返回两种网络结构：一个时间网络，这是一个时间关系的有向网络；一个同时网络，它是一个同时关系的无向网络。</p>
</section>
<section id="工具包" class="level4">
<h4 class="anchored" data-anchor-id="工具包">1.4 工具包</h4>
<p>可以实现上述几种时间序列数据网络分析的R包有多种，目前来看并不统一，单是我在各类文献中看到的工具包就不少，比如，有用<a href="https://link.springer.com/chapter/10.1007/978-3-031-54464-4_17#Sec6">时间社会网络分析（tsna）</a>的，有用多水平向量自回归(<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7530190/">mlVAR包</a>，Multi-Level Vector Autoregression)的，也有用<a href="https://mental.jmir.org/2024/1/e50136">时变向量自回归包（mgm包）</a>以及<a href="https://www.researchgate.net/publication/374951207_Peer_functioning_difficulties_may_exacerbate_symptoms_of_attention-deficithyperactivity_disorder_and_irritability_over_time_a_temporal_network_analysis?enrichId=rgreq-a67fefe7d73659d604617e894336fc35-XXX&amp;enrichSource=Y292ZXJQYWdlOzM3NDk1MTIwNztBUzoxMTQzMTI4MTIwMTIwMzk2OEAxNjk4MjQ3Nzg1NTQz&amp;el=1_x_3&amp;_esc=publicationCoverPdf">psychonetrics包（面板GVAR模型）</a>……</p>
<p>虽然让人眼花缭乱，但底层逻辑是相似的，主要还是要看你的研究类型和目的。譬如，mlVAR会分离出以下三种网络：</p>
<p><img src="images/时间序列---三种网络.png" class="img-fluid">{引用自WITH R NETWORK PSYCHOMETRICS=“” fig-align=“center”}</p>
<p>我在上述对应R包的名字上附上了具体文献或者代码仓库的超链接，你如果感兴趣的话，可以点进去看看这些文献对Temporal network analysis的具体实现方法。</p>
<p>个人比较推荐使用<strong>mlVAR</strong>构建时间序列网络模型。</p>
</section>
</section>
<section id="r语言实战" class="level3">
<h3 class="anchored" data-anchor-id="r语言实战">2 R语言实战</h3>
<section id="准备数据" class="level4">
<h4 class="anchored" data-anchor-id="准备数据">2.1 准备数据</h4>
<p>为了避免版本兼容性问题，大家可以先跳转到文末看看我使用的R语言环境。</p>
<p>先导入需要使用的程序包，没有安装的请先安装。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'mlVAR'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'mlVAR' was built under R version 4.3.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'qgraph'</span>) </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"networktools"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>本次我们用mlVAR包的mlVARsim函数模拟一份数据(实际是拟合也了一个时间网络模型)，为了减轻电脑的计算负担，设置受试者人数为50，节点数为8个，测量次数是30，阶数lag为1，其它都是默认设置。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Model <span class="ot">=</span> <span class="fu">mlVARsim</span>(<span class="at">nPerson =</span> <span class="dv">50</span>,<span class="at">nNode =</span> <span class="dv">8</span>, <span class="at">nTime =</span> <span class="dv">30</span>, <span class="at">lag=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>查看数据：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Model<span class="sc">$</span>Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          V1         V2         V3         V4         V5         V6          V7
1 -0.3947046  0.6283051 -1.2678458 -1.7344497 -3.4298764 -1.5974017  0.09894146
2  1.8501570 -0.3205794 -0.1576001 -2.7206812 -4.5943583 -0.9191869 -2.14874582
3  2.3839202 -1.6158505  0.1396443 -2.1052779 -0.9537626 -2.4299875  0.22429909
4 -2.2812695  3.1539275  0.5900282 -2.5753006 -1.6115047 -2.0194019 -1.02667115
5  1.4907908 -1.5062154 -0.1919787 -0.5141523 -1.6294655 -0.8039993 -2.05406600
6  0.5983460  1.4703204  1.8300108 -3.6673056 -2.4320034 -2.2530438  0.35204864
           V8 ID
1  0.71603054  1
2 -1.51668525  1
3 -0.65903437  1
4 -0.66868105  1
5 -0.03536088  1
6 -2.10945328  1</code></pre>
</div>
</div>
<p>查看节点名：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>Model<span class="sc">$</span>vars</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "V1" "V2" "V3" "V4" "V5" "V6" "V7" "V8"</code></pre>
</div>
</div>
<p>查看受试者变量：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>Model<span class="sc">$</span>idvar</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ID"</code></pre>
</div>
</div>
<p>绘图：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="时间网络分析_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="拟合模型" class="level4">
<h4 class="anchored" data-anchor-id="拟合模型">2.2 拟合模型</h4>
<p>好戏开始：用mlVAR函数拟合时间网络模型！</p>
<p>这里面的data、vars、idvar是必须写的，分别表示数据、要分析的变量名、代表受试者的变量。lags可以选用默认参数，estimator是估计器，具体的选项可以查看帮助文档，这里选择lmer；contemporaneous（同期网络）、temporal（时序网络）估计方法都采用”correlated”；nCores指定使用的cpu核心数，计算量不小，可以适当大一些。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">=</span> <span class="fu">mlVAR</span>(<span class="at">data =</span> Model<span class="sc">$</span>Data, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">vars =</span> Model<span class="sc">$</span>vars, </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">idvar =</span> Model<span class="sc">$</span>idvar, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">lags =</span> <span class="dv">1</span>, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">estimator =</span> <span class="st">"lmer"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">temporal =</span> <span class="st">"correlated"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">contemporaneous =</span> <span class="st">"correlated"</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">nCores =</span> <span class="dv">8</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">verbose =</span>F</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>总结模型：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
mlVAR estimation completed. Input was:
    - Variables: V1 V2 V3 V4 V5 V6 V7 V8 
    - Lags: 1 
    - Estimator: lmer 
    - Temporal: correlated

Information indices:
 var      aic      bic
  V1 2835.656 3162.973
  V2 2706.655 3033.972
  V3 2809.293 3136.611
  V4 2948.183 3275.501
  V5 2978.383 3305.701
  V6 2797.174 3124.492
  V7 3080.895 3408.213
  V8 3370.471 3697.788


Temporal effects:
 from to lag  fixed    SE     P ran_SD
   V1 V1   1  0.048 0.025 0.060  0.053
   V1 V2   1  0.024 0.026 0.366  0.085
   V1 V3   1 -0.047 0.024 0.054  0.032
   V1 V4   1  0.139 0.028 0.000  0.082
   V1 V5   1 -0.015 0.025 0.548  0.028
   V1 V6   1  0.238 0.024 0.000  0.004
   V1 V7   1 -0.116 0.029 0.000  0.092
   V1 V8   1  0.014 0.037 0.718  0.163
   V2 V1   1 -0.008 0.037 0.840  0.202
   V2 V2   1  0.066 0.038 0.082  0.213
   V2 V3   1 -0.435 0.031 0.000  0.144
   V2 V4   1 -0.075 0.041 0.070  0.234
   V2 V5   1  0.023 0.043 0.594  0.249
   V2 V6   1  0.002 0.032 0.950  0.158
   V2 V7   1 -0.211 0.042 0.000  0.228
   V2 V8   1 -0.021 0.041 0.606  0.212
   V3 V1   1  0.013 0.024 0.574  0.077
   V3 V2   1  0.485 0.027 0.000  0.121
   V3 V3   1  0.234 0.030 0.000  0.151
   V3 V4   1  0.366 0.044 0.000  0.269
   V3 V5   1 -0.103 0.025 0.000  0.083
   V3 V6   1 -0.008 0.026 0.759  0.105
   V3 V7   1  0.036 0.041 0.385  0.243
   V3 V8   1 -0.020 0.035 0.557  0.164
   V4 V1   1 -0.049 0.037 0.181  0.205
   V4 V2   1  0.272 0.031 0.000  0.155
   V4 V3   1 -0.155 0.036 0.000  0.195
   V4 V4   1  0.016 0.034 0.630  0.172
   V4 V5   1 -0.189 0.031 0.000  0.141
   V4 V6   1 -0.112 0.027 0.000  0.114
   V4 V7   1  0.003 0.028 0.904  0.095
   V4 V8   1 -0.335 0.036 0.000  0.171
   V5 V1   1 -0.384 0.028 0.000  0.112
   V5 V2   1  0.233 0.029 0.000  0.133
   V5 V3   1 -0.244 0.034 0.000  0.175
   V5 V4   1  0.065 0.028 0.022  0.105
   V5 V5   1  0.125 0.031 0.000  0.137
   V5 V6   1  0.181 0.030 0.000  0.135
   V5 V7   1  0.011 0.027 0.675  0.075
   V5 V8   1  0.037 0.040 0.364  0.202
   V6 V1   1  0.010 0.038 0.798  0.204
   V6 V2   1 -0.177 0.036 0.000  0.188
   V6 V3   1  0.164 0.042 0.000  0.233
   V6 V4   1  0.009 0.045 0.834  0.257
   V6 V5   1  0.307 0.039 0.000  0.202
   V6 V6   1  0.123 0.036 0.001  0.183
   V6 V7   1  0.065 0.038 0.088  0.187
   V6 V8   1 -0.058 0.054 0.283  0.311
   V7 V1   1 -0.479 0.027 0.000  0.067
   V7 V2   1 -0.047 0.026 0.066  0.059
   V7 V3   1 -0.214 0.027 0.000  0.063
   V7 V4   1  0.123 0.030 0.000  0.096
   V7 V5   1 -0.152 0.028 0.000  0.067
   V7 V6   1 -0.293 0.027 0.000  0.070
   V7 V7   1  0.097 0.034 0.004  0.141
   V7 V8   1  0.016 0.040 0.688  0.185
   V8 V1   1 -0.173 0.039 0.000  0.226
   V8 V2   1  0.037 0.028 0.181  0.126
   V8 V3   1 -0.006 0.031 0.855  0.155
   V8 V4   1  0.004 0.027 0.895  0.098
   V8 V5   1  0.017 0.034 0.612  0.175
   V8 V6   1 -0.253 0.031 0.000  0.160
   V8 V7   1 -0.146 0.035 0.000  0.176
   V8 V8   1 -0.037 0.037 0.314  0.183


Contemporaneous effects (posthoc estimated):
 v1 v2 P 1-&gt;2 P 1&lt;-2   pcor ran_SD_pcor    cor ran_SD_cor
 V2 V1  0.099  0.060 -0.076       0.196 -0.348      0.239
 V3 V1  0.402  0.693  0.026       0.171  0.151      0.206
 V3 V2  0.640  0.461  0.023       0.152  0.014      0.184
 V4 V1  0.171  0.116 -0.058       0.160 -0.077      0.257
 V4 V2  0.210  0.382 -0.046       0.194  0.004      0.293
 V4 V3  0.000  0.000 -0.169       0.141 -0.147      0.187
 V5 V1  0.000  0.000 -0.301       0.165 -0.463      0.173
 V5 V2  0.001  0.003  0.117       0.144  0.321      0.191
 V5 V3  0.000  0.000 -0.266       0.109 -0.290      0.146
 V5 V4  0.001  0.001 -0.151       0.226 -0.053      0.269
 V6 V1  0.000  0.000  0.194       0.221  0.408      0.166
 V6 V2  0.000  0.000 -0.286       0.131 -0.464      0.192
 V6 V3  0.716  0.512  0.021       0.171  0.088      0.213
 V6 V4  0.220  0.386 -0.042       0.163 -0.042      0.273
 V6 V5  0.000  0.000 -0.206       0.235 -0.402      0.231
 V7 V1  0.000  0.000 -0.237       0.179 -0.385      0.182
 V7 V2  0.000  0.000  0.223       0.153  0.442      0.183
 V7 V3  0.501  0.253 -0.034       0.130 -0.017      0.203
 V7 V4  0.000  0.001  0.140       0.160  0.142      0.236
 V7 V5  0.467  0.281  0.042       0.227  0.241      0.209
 V7 V6  0.687  0.536  0.019       0.132 -0.282      0.189
 V8 V1  0.169  0.173  0.053       0.149 -0.142      0.235
 V8 V2  0.000  0.000  0.251       0.113  0.417      0.167
 V8 V3  0.000  0.000  0.265       0.147  0.252      0.187
 V8 V4  0.859  0.813  0.001       0.138  0.011      0.168
 V8 V5  0.426  0.391 -0.031       0.138  0.068      0.182
 V8 V6  0.024  0.007 -0.090       0.123 -0.244      0.208
 V8 V7  0.000  0.000  0.301       0.128  0.417      0.186


Between-subject effects:
 v1 v2 P 1-&gt;2 P 1&lt;-2   pcor    cor
 V2 V1  0.416  0.308  0.004 -0.082
 V3 V1  0.129  0.013 -0.255 -0.268
 V3 V2  0.791  0.555 -0.056 -0.020
 V4 V1  0.876  0.618 -0.040 -0.109
 V4 V2  0.711  0.547 -0.015 -0.146
 V4 V3  0.912  0.792  0.023  0.172
 V5 V1  0.184  0.021 -0.216 -0.218
 V5 V2  0.011  0.003  0.305  0.346
 V5 V3  0.085  0.113 -0.204  0.005
 V5 V4  0.083  0.027 -0.227 -0.123
 V6 V1  0.467  0.787 -0.032 -0.123
 V6 V2  0.614  0.333 -0.095 -0.258
 V6 V3  0.003  0.023  0.326  0.289
 V6 V4  0.000  0.001  0.398  0.313
 V6 V5  0.000  0.000  0.456  0.303
 V7 V1  0.411  0.125 -0.148 -0.055
 V7 V2  0.000  0.048 -0.366 -0.413
 V7 V3  0.018  0.105 -0.248 -0.148
 V7 V4  0.486  0.126  0.132  0.211
 V7 V5  0.461  0.072 -0.151 -0.271
 V7 V6  0.561  0.750  0.058  0.030
 V8 V1  0.487  0.080 -0.141 -0.162
 V8 V2  0.001  0.000  0.405  0.490
 V8 V3  0.209  0.061  0.187  0.029
 V8 V4  0.057  0.023  0.246  0.023
 V8 V5  0.240  0.636  0.094  0.018
 V8 V6  0.000  0.000 -0.522 -0.508
 V8 V7  0.220  0.173  0.150 -0.050</code></pre>
</div>
</div>
<p>上面给出了大量的信息。值得注意的是，mlVAR包会输出3种效应：Temporal effects、Contemporaneous effects、Between-subject effects，分别对应时序网络、同期网络和个体间网络。</p>
<ul>
<li><p><strong>Temporal effects（时间效应）</strong>：这是指变量在时间上对自身或其它变量的影响，这些效应通常是通过滞后回归权重来估计的，可以捕捉变量随时间的动态关系 。时序网络中的边是指变量在上个时间点t-1对下个时间点t的各节点的预测能力（控制了上个时间点t-1上的其他变量之后）。</p></li>
<li><p><strong>Contemporaneous effects（同期效应）</strong>：这是指在相同时间点上变量之间的关系，可以是简单的相关关系或偏相关关系。这些关系通常是通过模型残差的相互关系来估计的，可以揭示在同一时间点上变量之间的直接联系 。</p></li>
<li><p><strong>Between-subject effects（个体间效应）</strong>：这是指在不同个体之间（平均水平层面的）变量关系的差异，可以是相关关系或偏相关关系。这些效应反映了不同个体在变量关系上的差异，有助于理解不同个体在心理过程上的差异 。</p></li>
</ul>
</section>
<section id="可视化" class="level4">
<h4 class="anchored" data-anchor-id="可视化">2.3 可视化</h4>
<p>我们可以分别绘制这些网络图：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 同期网络</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>contemporaneous <span class="ot">=</span> <span class="fu">plot</span>(fit1, <span class="at">type =</span> <span class="st">"temporal"</span>, <span class="at">title =</span> <span class="st">"Estimated temporal relationships"</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">rule =</span> <span class="st">"and"</span>,<span class="at">layout =</span> <span class="st">"circle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>'nonsig' argument set to: 'hide'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="时间网络分析_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 时序网络</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>temporal<span class="ot">=</span><span class="fu">plot</span>(fit1, <span class="at">type =</span> <span class="st">"contemporaneous"</span>, <span class="at">rule =</span> <span class="st">"and"</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"Estimated contemporaneous relationships"</span>, <span class="at">layout =</span> <span class="st">"circle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>'nonsig' argument set to: 'hide'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="时间网络分析_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 受试者间网络  必须取名between，否则报错</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>between <span class="ot">=</span> <span class="fu">plot</span>(fit1, <span class="at">type =</span> <span class="st">"between"</span>, <span class="at">rule =</span> <span class="st">"or"</span>,</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">title =</span> <span class="st">"Estimated between relationships"</span>, <span class="at">layout =</span> <span class="st">"circle"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>'nonsig' argument set to: 'hide'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="时间网络分析_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="计算中心性" class="level4">
<h4 class="anchored" data-anchor-id="计算中心性">2.4 计算中心性</h4>
<p>可以跟横断面网络一样，计算或者开展后续一些常用的指标和检验，比如中心性，桥梁症状。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算中心性</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">centrality</span>(contemporaneous)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$OutDegree
       V1        V2        V3        V4        V5        V6        V7        V8 
0.4925390 0.6458855 0.9547871 1.0629915 1.1064859 0.6482566 1.2613704 0.5718523 

$InDegree
       V1        V2        V3        V4        V5        V6        V7        V8 
1.0367715 1.1672818 1.2120965 0.6931952 0.7514356 1.0759159 0.4729358 0.3345361 

$Closeness
        V1         V2         V3         V4         V5         V6         V7 
0.01729126 0.02204046 0.02279112 0.02429358 0.02367785 0.01927779 0.02422298 
        V8 
0.01778713 

$Betweenness
V1 V2 V3 V4 V5 V6 V7 V8 
 0  6 11  9  2  7  3  2 

$InExpectedInfluence
        V1         V2         V3         V4         V5         V6         V7 
-1.0367715  0.8130958 -0.8837218  0.6931952 -0.1374832 -0.2395795 -0.4729358 
        V8 
-0.3345361 

$OutExpectedInfluence
        V1         V2         V3         V4         V5         V6         V7 
 0.2604529 -0.6458855  0.7480166 -0.5193370 -0.1489642  0.2940706 -1.0152380 
        V8 
-0.5718523 

$ShortestPathLengths
         V1       V2        V3        V4        V5       V6        V7        V8
V1 0.000000 9.857263 10.301114  7.194495  7.468094 4.210512  8.617493 10.183709
V2 6.821349 0.000000  2.300362  5.032945 10.311282 8.147526  4.735490  8.022159
V3 8.881303 2.059954  0.000000  2.732583  8.010919 9.674736  6.795444  5.721797
V4 7.881161 3.678807  5.979169  0.000000  5.278337 6.942153  8.414297  2.989214
V5 2.602824 4.293433  4.106320  6.838903  0.000000 5.535034  9.028923  9.828117
V6 5.860406 5.646751  6.090602  8.823185  3.257582 0.000000 10.382241 11.812399
V7 2.085859 6.728823  4.668869  7.401452  6.595413 3.412036  0.000000 10.390666
V8 5.775185 9.599691 10.043541 12.776124  7.210521 3.952939  6.862411  0.000000

$ShortestPaths
   V1   V2   V3   V4   V5   V6   V7   V8  
V1 NULL NULL NULL NULL NULL NULL NULL NULL
V2 NULL NULL NULL NULL NULL NULL NULL NULL
V3 NULL NULL NULL NULL NULL NULL NULL NULL
V4 NULL NULL NULL NULL NULL NULL NULL NULL
V5 NULL NULL NULL NULL NULL NULL NULL NULL
V6 NULL NULL NULL NULL NULL NULL NULL NULL
V7 NULL NULL NULL NULL NULL NULL NULL NULL
V8 NULL NULL NULL NULL NULL NULL NULL NULL</code></pre>
</div>
</div>
<p>可以将其绘制出来，下面的代码依次绘制同期网络、时序网络和个体间网络。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">centralityPlot</span>(contemporaneous) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="时间网络分析_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">centralityPlot</span>(temporal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="时间网络分析_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">centralityPlot</span>(between)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="时间网络分析_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>完全可以对绘图函数的参数做些个性化调整，这里不多展示了。</p>
</section>
<section id="桥梁症状分析" class="level4">
<h4 class="anchored" data-anchor-id="桥梁症状分析">2.5 桥梁症状分析</h4>
<p>先人为对模拟数据的节点进行分组：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>groups<span class="ot">=</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">'A'</span>,<span class="dv">4</span>),<span class="fu">rep</span>(<span class="st">'B'</span>,<span class="dv">2</span>),<span class="fu">rep</span>(<span class="st">'C'</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>计算桥梁中心性指标：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>b <span class="ot">=</span> <span class="fu">bridge</span>(contemporaneous, <span class="at">communities=</span> groups, <span class="at">directed=</span>F)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$`Bridge Strength`
       V1        V2        V3        V4        V5        V6        V7        V8 
0.3535438 0.2111714 0.1033853 0.6356809 0.9258186 0.3412804 1.2613704 0.4261309 

$`Bridge Betweenness`
V1 V2 V3 V4 V5 V6 V7 V8 
 4  0  0  2  0  3  0  0 

$`Bridge Closeness`
        V1         V2         V3         V4         V5         V6         V7 
0.14330694        NaN 0.05915372 0.07055906 0.06471345 0.10082979        NaN 
        V8 
       NaN 

$`Bridge Expected Influence (1-step)`
         V1          V2          V3          V4          V5          V6 
 0.12145776 -0.21117138 -0.10338527 -0.63568093 -0.32963154 -0.01290559 
         V7          V8 
-1.01523798 -0.42613095 

$`Bridge Expected Influence (2-step)`
         V1          V2          V3          V4          V5          V6 
 0.15761269 -0.07232028 -0.45720635 -0.61214425 -0.71277807  0.14007662 
         V7          V8 
-1.44229388 -0.41777398 

$communities
[1] "A" "A" "A" "A" "B" "B" "C" "C"</code></pre>
</div>
</div>
<p>简单绘图：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(b, <span class="at">include=</span><span class="fu">c</span>(<span class="st">"Bridge Expected Influence (2-step)"</span>, <span class="st">"Bridge Strength"</span>, <span class="st">"Bridge Closeness"</span>),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">theme_bw=</span>F, <span class="at">raw0 =</span> T, <span class="at">signed=</span>T) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Vectorized input to `element_text()` is not officially supported.
ℹ Results may be unexpected or may change in future versions of ggplot2.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values or values outside the scale range
(`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="时间网络分析_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="几个需要注意的地方" class="level3">
<h3 class="anchored" data-anchor-id="几个需要注意的地方">3 几个需要注意的地方</h3>
<p>时间网络分析目前还不完善，上述流程并没有覆盖到之前我们做横断面网络的所有评估指标和检验方法，比如稳定性、精确性、差异性检验，我还没有找到合适的R包可以很方便地对其进行分析（估计得自己写重抽样代码）。</p>
<p>此外，时间网络分析不同于CLPM网络分析，其对数据有一些要求，比如说测量次数多、满足多元正态分布、具备平稳性……</p>
<p>你如果有一份生态瞬时数据或者密集追踪数据，且想要进行时间网络分析，建议在建模前检查下数据，包括正态性（不服从也可以做）、平稳性（KPSS平稳性检验，文献提到可以用R包tseries实现，要一个个做，所以代码有些复杂），等等。</p>
<section id="运行环境" class="level4">
<h4 class="anchored" data-anchor-id="运行环境"><strong>运行环境</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.2 (2023-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 19045)

Matrix products: default


locale:
[1] LC_COLLATE=Chinese (Simplified)_China.utf8 
[2] LC_CTYPE=Chinese (Simplified)_China.utf8   
[3] LC_MONETARY=Chinese (Simplified)_China.utf8
[4] LC_NUMERIC=C                               
[5] LC_TIME=Chinese (Simplified)_China.utf8    

time zone: Asia/Shanghai
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] networktools_1.5.1 qgraph_1.9.8       mlVAR_0.5.2       

loaded via a namespace (and not attached):
  [1] mnormt_2.1.1            pbapply_1.7-2           polynom_1.4-1          
  [4] gridExtra_2.3           fdrtool_1.2.17          rlang_1.1.3            
  [7] magrittr_2.0.3          e1071_1.7-13            compiler_4.3.2         
 [10] gdata_3.0.0             png_0.1-8               vctrs_0.6.4            
 [13] reshape2_1.4.4          quadprog_1.5-8          stringr_1.5.1          
 [16] pkgconfig_2.0.3         shape_1.4.6             fastmap_1.1.1          
 [19] arm_1.13-1              backports_1.4.1         labeling_0.4.3         
 [22] pbivnorm_0.6.0          pander_0.6.5            utf8_1.2.4             
 [25] rmarkdown_2.25          heplots_1.6.0           nloptr_2.0.3           
 [28] purrr_1.0.2             jomo_2.7-6              xfun_0.41              
 [31] glmnet_4.1-8            clusterGeneration_1.3.8 jsonlite_1.8.7         
 [34] pan_1.9                 jpeg_0.1-10             psych_2.3.9            
 [37] broom_1.0.5             parallel_4.3.2          lavaan_0.6-17          
 [40] cluster_2.1.4           R6_2.5.1                stringi_1.8.1          
 [43] RColorBrewer_1.1-3      smacof_2.1-5            car_3.1-2              
 [46] boot_1.3-28.1           rpart_4.1.21            Rcpp_1.0.11            
 [49] iterators_1.0.14        knitr_1.45              base64enc_0.1-3        
 [52] R.utils_2.12.3          weights_1.0.4           Matrix_1.6-5           
 [55] splines_4.3.2           nnls_1.5                nnet_7.3-19            
 [58] igraph_2.0.1.1          tidyselect_1.2.0        rstudioapi_0.16.0      
 [61] abind_1.4-5             yaml_2.3.7              doParallel_1.0.17      
 [64] codetools_0.2-19        lattice_0.21-9          tibble_3.2.1           
 [67] plyr_1.8.9              withr_2.5.2             coda_0.19-4            
 [70] evaluate_0.23           foreign_0.8-85          fastDummies_1.7.3      
 [73] survival_3.5-7          proxy_0.4-27            texreg_1.39.3          
 [76] pillar_1.9.0            carData_3.0-5           mice_3.16.0            
 [79] checkmate_2.3.0         foreach_1.5.2           stats4_4.3.2           
 [82] ellipse_0.5.0           generics_0.1.3          ggplot2_3.5.0          
 [85] candisc_0.8-6           munsell_0.5.0           scales_1.3.0           
 [88] minqa_1.2.6             gtools_3.9.5            xtable_1.8-4           
 [91] class_7.3-22            glue_1.6.2              Hmisc_5.1-1            
 [94] tools_4.3.2             data.table_1.15.4       lme4_1.1-35.1          
 [97] gsubfn_0.7              rgl_1.2.1               mvtnorm_1.2-3          
[100] grid_4.3.2              plotrix_3.8-4           tidyr_1.3.1            
[103] MplusAutomation_1.1.1   colorspace_2.1-0        nlme_3.1-163           
[106] graphicalVAR_0.3.4      htmlTable_2.4.2         eigenmodel_1.11        
[109] proto_1.0.0             Formula_1.2-5           cli_3.6.2              
[112] fansi_1.0.5             dplyr_1.1.4             corpcor_1.6.10         
[115] glasso_1.11             gtable_0.3.4            R.methodsS3_1.8.2      
[118] digest_0.6.33           wordcloud_2.6           farver_2.1.1           
[121] htmlwidgets_1.6.2       htmltools_0.5.7         R.oo_1.25.0            
[124] lifecycle_1.0.4         httr_1.4.7              mitml_0.4-5            
[127] MASS_7.3-60            </code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./交叉滞后网络.html" class="pagination-link" aria-label="交叉滞后网络">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">交叉滞后网络</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./协变量处理方法.html" class="pagination-link" aria-label="协变量处理方法">
        <span class="nav-page-text">协变量处理方法</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>